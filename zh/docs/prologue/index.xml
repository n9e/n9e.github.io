<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>前言 on</title><link>https://n9e.github.io/zh/docs/prologue/</link><description>Recent content in 前言 on</description><generator>Hugo -- gohugo.io</generator><language>en-US</language><lastBuildDate>Tue, 06 Oct 2020 08:48:45 +0000</lastBuildDate><atom:link href="https://n9e.github.io/zh/docs/prologue/index.xml" rel="self" type="application/rss+xml"/><item><title>夜莺项目介绍</title><link>https://n9e.github.io/zh/docs/prologue/introduction/</link><pubDate>Sat, 25 Jan 2025 08:48:57 +0800</pubDate><guid>https://n9e.github.io/zh/docs/prologue/introduction/</guid><description>夜莺监控（Nightingale）是一款专注于告警的监控类开源项目。与 Grafana 类似，夜莺也采用数据源集成方式，支持对接多种现有数据源。两者的区别在于：Grafana 侧重于数据可视化，而夜莺侧重于告警引擎、告警事件的处理和分发。
夜莺监控项目最初由滴滴公司开发和开源，并于 2022 年 5 月 11 日捐赠予中国计算机学会开源技术发展委员会（CCF ODC），成为 CCF ODC 成立后接受捐赠的第一个开源项目。
代码仓库 # 后端：https://github.com/ccfos/nightingale 前端：https://github.com/n9e/fe 如果是前端交互问题，请在 https://github.com/n9e/fe 提交 issue。其他问题请在 https://github.com/ccfos/nightingale 提交 issue。
工作原理 # 当用户已具备指标和日志数据采集能力时，可将现有存储系统（如 VictoriaMetrics、ElasticSearch 等）作为数据源接入夜莺，在夜莺中配置告警规则和通知规则，实现告警事件的生成和分发。这种模式下，夜莺不采集数据、不存储数据，仅作为告警引擎。
如果您尚未采集监控数据，也可以使用 Categraf 作为采集器，Categraf 可以与夜莺丝滑对接。
Categraf 支持采集操作系统、网络设备、各类中间件和数据库的监控数据，通过 Remote Write 协议将数据推送至夜莺。这种模式下，夜莺仍然不存储监控数据，而是充当数据转发网关，将监控数据做一些处理然后转存至时序数据库（如 Prometheus、VictoriaMetrics 等）。
对于网络链路不稳定的边缘机房场景，为提升告警可用性，夜莺提供边缘机房告警引擎下沉部署模式。在此模式下，即使边缘机房与中心机房网络中断，告警功能仍可正常运行（具体可参考架构设计章节）。
上图中，机房 A 与中心机房网络链路稳定，因此直接由中心端的夜莺进程执行告警引擎功能；机房 B 与中心机房网络链路不稳定，因此在机房 B 部署 n9e-edge 作为告警引擎，对机房 B 的数据源进行告警判定。
告警降噪、升级与协同 # 夜莺的核心功能是告警引擎，负责生成告警事件、对事件做二次处理后根据通知规则进行灵活分发。系统内置支持 20 多种通知媒介，包括电话、短信、邮件、钉钉、飞书、企业微信、Slack 等。
对于以下高级需求场景，夜莺可能无法满足：
需要将企业内多套监控系统（比如各类云监控、Zabbix）产生的事件统一汇聚至单一平台，进行收敛降噪、响应处理和数据分析 需要支持人员排班、On-call 管理、告警认领、升级机制（避免遗漏）和协同处理 针对上述场景，强烈建议使用 FlashDuty 等专业的 On-call 管理产品，将云上、云下各类监控系统的告警统一汇聚，进行降噪、分发和响应管理。</description></item><item><title>夜莺对比 Prometheus</title><link>https://n9e.github.io/zh/docs/prologue/prometheus/</link><pubDate>Fri, 30 May 2025 21:37:49 +0800</pubDate><guid>https://n9e.github.io/zh/docs/prologue/prometheus/</guid><description>夜莺监控（Nightingale）与 Grafana 类似，支持对接多种数据源。Prometheus 是最常用的数据源（其他兼容 Prometheus 接口的数据源，如 VictoriaMetrics、Thanos、M3DB 等，均可视为 Prometheus 类型数据源），因此夜莺与 Prometheus 关系密切。
适用场景 # 在以下场景中，建议考虑使用夜莺监控：
多数据源统一管理：存在多套时序数据库（如 Prometheus、VictoriaMetrics 等），需要统一的平台管理各类告警规则，并具备权限管控能力 高可用告警引擎：Prometheus 的告警引擎为单点架构，存在单机故障导致告警功能不可用的风险 多数据源告警：除 Prometheus 外，还需要支持 ElasticSearch、Loki、ClickHouse 等其他数据源的告警能力 灵活的告警配置：需要更灵活的告警规则配置，包括生效时间控制、事件 Relabel、与 CMDB 系统联动、告警联动自愈脚本等功能 典型技术架构 # 在实际生产环境中，企业通常采用组合技术方案，各组件发挥其优势：
数据采集层：采用多种 agent 和 exporter 组合方案，主要使用 Categraf（特别适用于机器监控场景，与夜莺无缝集成），同时辅以各类 Exporter 数据存储层：时序数据库主要采用 VictoriaMetrics。VictoriaMetrics 兼容 Prometheus 接口，性能更优且提供集群版本，对于大多数企业而言，单机版本即可满足需求 告警引擎层：使用夜莺作为告警引擎，支持多团队协作管理，内置开箱即用的告警规则模板，提供灵活的告警规则配置能力，通过事件 Pipeline 机制实现与 CMDB 等系统的集成 可视化层：使用 Grafana 进行数据可视化，提供丰富的图表类型和展示效果，社区资源丰富，可从 Grafana 官方站点获取大量现成的仪表盘模板 告警事件管理：使用 FlashDuty 进行告警事件的 On-call 分发，支持对接 Zabbix、Prometheus、夜莺、各云监控平台、Elastalert 等各类监控系统，统一收敛降噪、排班、认领升级、响应、派发等告警处理流程</description></item><item><title>学习夜莺的前置知识</title><link>https://n9e.github.io/zh/docs/prologue/pre-knowledge/</link><pubDate>Fri, 30 May 2025 22:03:32 +0800</pubDate><guid>https://n9e.github.io/zh/docs/prologue/pre-knowledge/</guid><description>夜莺监控（Nightingale）属于 Prometheus 生态体系的一部分，因此 Prometheus 的核心概念和知识是使用夜莺的前置条件。本文梳理了关键知识点，请给位读者查漏补缺。对于不熟悉的知识，可以先向 AI 提问获得初步了解。
基础知识 # Linux 系统知识 # 如何查看进程日志：了解 stdout、stderr 的概念，了解文件句柄和 lsof 命令。 了解 systemd：如果是二进制部署，建议使用 systemd 管理进程，需要了解 systemd 的基础知识，比如使用 journalctl 查看日志。 了解 Docker 知识：如果使用容器部署夜莺、Categraf，需要了解容器基础知识。 监控知识 # 监控基础概念 # 数据模型：指标（Metric）、标签（Label）、时间序列（Time Series） 采集方式：Pull 模式、Push 模式 推荐学习资源：
Prometheus 官方文档 Prometheus 中文文档 运维监控系统实战笔记 PromQL 查询语言 # PromQL（Prometheus Query Language）是使用 Prometheus 和夜莺监控的核心技能。掌握 PromQL 能够帮助您：
查询和分析监控指标 构建告警规则 创建监控大盘 推荐学习资源：
PromQL 系列教程 夜莺相关问题排查思路 # 确定问题边界 # 理解架构原理：了解夜莺监控的整体架构和各组件职责 掌握数据流向：理解数据从采集、传输、存储、告警、屏蔽、发送通知的完整流程 定位问题模块：根据问题现象，确定可能涉及的模块，缩小排查范围 查阅文档和日志 # 查阅官方文档：优先查阅夜莺监控的官方文档和常见问题 分析系统日志：查看相关组件的日志文件，定位错误信息 使用搜索工具：通过关键字搜索日志内容，或使用搜索引擎查找类似问题 借助 AI 工具：将日志内容提交给 AI 工具进行分析，获取排查建议 提问方法 # 《提问的智慧》：由著名开源软件专家 Eric S.</description></item><item><title>夜莺架构设计</title><link>https://n9e.github.io/zh/docs/prologue/architecture/</link><pubDate>Fri, 30 May 2025 22:31:56 +0800</pubDate><guid>https://n9e.github.io/zh/docs/prologue/architecture/</guid><description>夜莺的架构比较简单，如果只是测试功能，一个二进制就可以启动，如果要上到生产环境，则要依赖 MySQL 和 Redis。有些公司会有多个机房，有些边缘机房和中心机房的网络质量较差，夜莺也针对这种情况做了专门的设计。
架构图 # 不考虑边缘模式的话，夜莺只有一个主进程，即 n9e 进程，依赖 MySQL 和 Redis 存储一些管理数据，可以接入多种数据源，技术架构图示意如下：
初期支持的数据源：Prometheus、VictoriaMetrics、ElasticSearch，既支持看图也支持告警，后面夜莺侧重在做告警引擎，所以后面新支持的数据源就只支持告警。
根据监控数据是否流经夜莺，可以分成两个模式：
模式1：监控数据不流经夜莺，用户自己搞定数据采集的问题，仅把时序库配置到夜莺里，使用夜莺看图和配置告警。上面的架构图就是典型的这种模式。 模式2：数据流经夜莺，Categraf 通过 remote write 协议把数据推给夜莺，夜莺不直接存储数据，而是把数据转存到时序库，转存到哪些时序库？由夜莺配置文件 config.toml 中的 Pushgw.Writers 来决定，模式2下的架构图如下： 上图中，夜莺接到监控数据之后转发给了 VictoriaMetrics，当然，也可以转发给 Prometheus，如果要转发给 Prometheus，记得 Prometheus 启动的时候要打开 remote receiver 的功能（./prometheus --help | grep receiver 可以看到具体是要加哪个控制参数），即开启 Prometheus 的 /api/v1/write 接口。
🟢 如果是新用户，建议直接使用 VictoriaMetrics，VictoriaMetrics 性能更好，且支持集群模式，而且，和 Prometheus 接口兼容。不过 VictoriaMetrics 的中文资料比 Prometheus 更少一些。
单节点测试模式 # 从夜莺的 github releases 下载发布包，解压之后里边有个 n9e 二进制文件，直接 ./n9e 就可以运行起来，默认端口是 17000，默认用户名是 root，密码是 root.2020。</description></item><item><title>夜莺商业版</title><link>https://n9e.github.io/zh/docs/prologue/flashcat/</link><pubDate>Fri, 30 May 2025 22:31:56 +0800</pubDate><guid>https://n9e.github.io/zh/docs/prologue/flashcat/</guid><description>夜莺监控（Nightingale）的主力开发人员是全职在做开源，如果没有收入养家糊口，项目也就无法持续了。所以他们创办了一家企业：北京快猫星云科技有限公司，简称“快猫”，推出了两款商业产品：
一站式智能观测平台Flashcat 一站式告警响应平台Flashduty 其中 Flashcat 可以看做是夜莺的商业版，定位是统一的观测平台，开源版则只是侧重在指标监控，二者的区别可以参考这篇文章：《夜莺开源版和商业版的区别》。
FlashDuty 则是类似 PagerDuty 的一站式告警响应平台（即 On-call 中心），支持对接 Zabbix、Prometheus、夜莺、各云监控、Elastalert 等各类监控系统，收拢告警事件到一个平台，统一对告警做收敛降噪、排班、认领升级、响应、派发等。可以免费注册试用。
监控、可观测性领域的知识确实非常驳杂，如果您有预算需要乙方协助，可以考虑快猫的产品，多方共赢 👉 免费与快猫做产品思路交流。</description></item><item><title>入门视频教程</title><link>https://n9e.github.io/zh/docs/prologue/videos/</link><pubDate>Wed, 02 Jul 2025 15:02:21 +0800</pubDate><guid>https://n9e.github.io/zh/docs/prologue/videos/</guid><description>为了方便大家快速上手使用夜莺监控（Nightingale），我们制作了一系列入门视频教程，涵盖了从安装部署到基本使用的各个方面。以下是这些视频的列表（建议两倍速播放，快速浏览一遍）：
夜莺项目介绍、资料地址等，必看 夜莺架构讲解 基础功能入门体验 安装 Categraf 对接夜莺 介绍 Categraf 常见插件 通知规则入门讲解</description></item></channel></rss>