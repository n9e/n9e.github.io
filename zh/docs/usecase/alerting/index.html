<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=preload as=font href=https://n9e.github.io/fonts/vendor/jost/jost-v4-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://n9e.github.io/fonts/vendor/jost/jost-v4-latin-500.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://n9e.github.io/fonts/vendor/jost/jost-v4-latin-700.woff2 type=font/woff2 crossorigin><script>(()=>{var t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,e=localStorage.getItem("theme");t&&e===null&&(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-dark-mode","")),t&&e==="dark"&&document.documentElement.setAttribute("data-dark-mode",""),e==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script><link rel=stylesheet href=https://n9e.github.io/main.d523d29caf33c54c2b0c3195c767ddb473d496a2fc220229024e0fb9f1c8072e6e5a6f83af8bf6bc3b7df943559fcb68c6a20cf51f02f65c46cadfae58c9437f.css integrity="sha512-1SPSnK8zxUwrDDGVx2fdtHPUlqL8IgIpAk4PufHIBy5uWm+Dr4v2vDt9+UNVn8toxqIM9R8C9lxGyt+uWMlDfw==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>告警原理和流程说明 - Nightingale</title><meta name=description content="夜莺监控（Nightingale）最重要的功能就是告警引擎。本文介绍了夜莺的告警原理和数据流，把整个告警流程中涉及到的相关功能都介绍一下。"><link rel=canonical href=https://n9e.github.io/zh/docs/usecase/alerting/><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:title" content="告警原理和流程说明"><meta property="og:description" content="夜莺监控（Nightingale）最重要的功能就是告警引擎。本文介绍了夜莺的告警原理和数据流，把整个告警流程中涉及到的相关功能都介绍一下。"><meta property="og:url" content="https://n9e.github.io/zh/docs/usecase/alerting/"><meta property="og:site_name" content="Home"><meta property="article:published_time" content="2025-06-23T11:00:09+08:00"><meta property="article:modified_time" content="2025-07-26T13:20:15+08:00"><meta property="og:image" content="https://n9e.github.io/doks.png"><meta property="og:image:alt" content="Home"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@ulricqin"><meta name=twitter:creator content="@henkverlinde"><meta name=twitter:title content="告警原理和流程说明"><meta name=twitter:description content="夜莺监控（Nightingale）最重要的功能就是告警引擎。本文介绍了夜莺的告警原理和数据流，把整个告警流程中涉及到的相关功能都介绍一下。"><meta name=twitter:image content="https://n9e.github.io/doks.png"><meta name=twitter:image:alt content="告警原理和流程说明"><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"https://n9e.github.io/#/schema/organization/1","name":"Doks","url":"https://n9e.github.io/","sameAs":["https://twitter.com/ulricqin","https://github.com/ccfos/nightingale"],"logo":{"@type":"ImageObject","@id":"https://n9e.github.io/#/schema/image/1","url":"https://n9e.github.io/logo-doks.png","width":512,"height":512,"caption":"Doks"},"image":{"@id":"https://n9e.github.io/#/schema/image/1"}},{"@type":"WebSite","@id":"https://n9e.github.io/#/schema/website/1","url":"https://n9e.github.io/","name":"Home","description":"Nightingale is an open-source monitoring system that focuses on alerting.","publisher":{"@id":"https://n9e.github.io/#/schema/organization/1"}},{"@type":"WebPage","@id":"https://n9e.github.io/zh/docs/usecase/alerting/","url":"https://n9e.github.io/zh/docs/usecase/alerting/","name":"告警原理和流程说明","description":"夜莺监控（Nightingale）最重要的功能就是告警引擎。本文介绍了夜莺的告警原理和数据流，把整个告警流程中涉及到的相关功能都介绍一下。","isPartOf":{"@id":"https://n9e.github.io/#/schema/website/1"},"about":{"@id":"https://n9e.github.io/#/schema/organization/1"},"datePublished":"2025-06-23T11:00:09CET","dateModified":"2025-07-26T13:20:15CET","breadcrumb":{"@id":"https://n9e.github.io/zh/docs/usecase/alerting/#/schema/breadcrumb/1"},"primaryImageOfPage":{"@id":"https://n9e.github.io/zh/docs/usecase/alerting/#/schema/image/2"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://n9e.github.io/zh/docs/usecase/alerting/"]}]},{"@type":"BreadcrumbList","@id":"https://n9e.github.io/zh/docs/usecase/alerting/#/schema/breadcrumb/1","name":"Breadcrumbs","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"https://n9e.github.io/","url":"https://n9e.github.io/","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@type":"WebPage","@id":"https://n9e.github.io/zh/","url":"https://n9e.github.io/zh/","name":"Zh"}},{"@type":"ListItem","position":3,"item":{"@type":"WebPage","@id":"https://n9e.github.io/zh/docs/","url":"https://n9e.github.io/zh/docs/","name":"Docs"}},{"@type":"ListItem","position":4,"item":{"@type":"WebPage","@id":"https://n9e.github.io/zh/docs/usecase/","url":"https://n9e.github.io/zh/docs/usecase/","name":"Usecase"}},{"@type":"ListItem","position":5,"item":{"@id":"https://n9e.github.io/zh/docs/usecase/alerting/"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Article","@id":"https://n9e.github.io/#/schema/article/1","headline":"告警原理和流程说明","description":"夜莺监控（Nightingale）最重要的功能就是告警引擎。本文介绍了夜莺的告警原理和数据流，把整个告警流程中涉及到的相关功能都介绍一下。","isPartOf":{"@id":"https://n9e.github.io/zh/docs/usecase/alerting/"},"mainEntityOfPage":{"@id":"https://n9e.github.io/zh/docs/usecase/alerting/"},"datePublished":"2025-06-23T11:00:09CET","dateModified":"2025-07-26T13:20:15CET","author":{"@id":"https://n9e.github.io/#/schema/person/2"},"publisher":{"@id":"https://n9e.github.io/#/schema/organization/1"},"image":{"@id":"https://n9e.github.io/zh/docs/usecase/alerting/#/schema/image/2"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Person","@id":"https://n9e.github.io/#/schema/person/2","name":"Henk Verlinde","sameAs":["https://twitter.com/henkverlinde","https://www.linkedin.com/in/henkverlinde/","https://github.com/UlricQin"]}]},{"@context":"https://schema.org","@graph":[{"@type":"ImageObject","@id":"https://n9e.github.io/zh/docs/usecase/alerting/#/schema/image/2","url":"https://n9e.github.io/doks.png","contentUrl":"https://n9e.github.io/doks.png","caption":"告警原理和流程说明"}]}]}</script><meta name=theme-color content="#fff"><link rel=apple-touch-icon sizes=180x180 href=https://n9e.github.io/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://n9e.github.io/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://n9e.github.io/favicon-16x16.png><link rel=manifest crossorigin=use-credentials href=https://n9e.github.io/site.webmanifest></head><body class="docs single"><div class=header-bar></div><header class="navbar navbar-expand-md navbar-light doks-navbar"><nav class="container-xxl flex-wrap flex-md-nowrap" aria-label="Main navigation"><a class="navbar-brand p-0 me-auto" href=/zh/ aria-label=Home>Home</a>
<button class="btn btn-menu d-block d-md-none order-5" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasDoks aria-controls=offcanvasDoks aria-label="Open main menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button><div class="offcanvas offcanvas-end border-0 py-md-1" tabindex=-1 id=offcanvasDoks data-bs-backdrop=true aria-labelledby=offcanvasDoksLabel><div class="header-bar d-md-none"></div><div class="offcanvas-header d-md-none"><h2 class="h5 offcanvas-title ps-2" id=offcanvasDoksLabel><a class=text-dark href=/zh/>Home</a></h2><button type=button class="btn-close text-reset me-2" data-bs-dismiss=offcanvas aria-label="Close main menu"></button></div><div class="offcanvas-body px-4"><h3 class="h6 text-uppercase mb-3 d-md-none">Main</h3><ul class="nav flex-column flex-md-row ms-md-n3"><li class=nav-item><a class="nav-link ps-0 py-1" href=/zh/docs/prologue/introduction/>文档</a></li></ul><hr class="text-black-50 my-4 d-md-none"><h3 class="h6 text-uppercase mb-3 d-md-none">Socials</h3><ul class="nav flex-column flex-md-row ms-md-auto me-md-n5 pe-md-2"><li class=nav-item><a class="nav-link ps-0 py-1" href=https://github.com/ccfos/nightingale><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg><small class="ms-2 d-md-none">GitHub</small></a></li></ul></div></div><button id=mode class="btn btn-link order-md-1" type=button aria-label="Toggle user interface mode">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button><div class="dropdown order-md-2"><button class="btn btn-doks-light dropdown-toggle" id=doks-languages data-bs-toggle=dropdown aria-expanded=false data-bs-display=static>
ZH
<span class=dropdown-caret><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"/></svg></span></button><ul class="dropdown-menu dropdown-menu-end shadow rounded border-0" aria-labelledby=doks-languages><li><a class="dropdown-item current" aria-current=true href=/zh/docs/usecase/alerting/>Chinese</a></li><li><hr class=dropdown-divider></li><li><a class=dropdown-item rel=alternate href=/zh/en hreflang=en lang=en>English</a></li></ul></div></nav></header><nav class="doks-subnavbar py-2 sticky-lg-top" aria-label="Secondary navigation"><div class="container-xxl d-flex align-items-md-center"><form class="doks-search position-relative flex-grow-1 me-auto"><input id=search class="form-control is-search" type=search placeholder="Search docs..." aria-label="Search docs..." autocomplete=off><div id=suggestions class="shadow bg-white rounded d-none"></div></form><button class="btn doks-sidebar-toggle d-lg-none ms-3 order-3 collapsed" type=button data-bs-toggle=collapse data-bs-target=#doks-docs-nav aria-controls=doks-docs-nav aria-expanded=false aria-label="Toggle documentation navigation"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="doks doks-expand" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Expand</title><polyline points="7 13 12 18 17 13"/><polyline points="7 6 12 11 17 6"/></svg><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="doks doks-collapse" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Collapse</title><polyline points="17 11 12 6 7 11"/><polyline points="17 18 12 13 7 18"/></svg></button></div></nav><div class=container-xxl><aside class=doks-sidebar><nav id=doks-docs-nav class="collapse d-lg-none" aria-label="Tertiary navigation"><ul class="list-unstyled collapsible-sidebar"><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-df36888424843793b8bfe4fd460c9b87 aria-expanded=false>
前言</button><div class=collapse id=section-df36888424843793b8bfe4fd460c9b87><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/prologue/introduction/>夜莺项目介绍</a></li><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/prologue/prometheus/>夜莺对比 Prometheus</a></li><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/prologue/pre-knowledge/>学习夜莺的前置知识</a></li><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/prologue/architecture/>夜莺架构设计</a></li><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/prologue/flashcat/>夜莺商业版</a></li><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/prologue/videos/>入门视频教程</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-e655a410ff21cd07e7a0150491e04371 aria-expanded=false>
安装</button><div class=collapse id=section-e655a410ff21cd07e7a0150491e04371><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/install/pre-intro/>安装前置说明</a></li><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/install/upgrade/>升级</a></li><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/install/binary/>二进制部署</a></li><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/install/compose/>Docker Compose</a></li><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/install/helm/>Helm</a></li><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/install/configuration/>配置讲解</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-15ad62fa6c036f6a916b4336fe04c118 aria-expanded=false>
采集器</button><div class=collapse id=section-15ad62fa6c036f6a916b4336fe04c118><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/agent/intro/>前置说明</a></li><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/agent/categraf/>Categraf</a></li><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/agent/telegraf/>Telegraf</a></li><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/agent/datadog-agent/>Datadog-Agent</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-282a264a821e1d594e596f99f61e057d aria-expanded=false>
快速体验</button><div class=collapse id=section-282a264a821e1d594e596f99f61e057d><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/usage/datasource/>数据源</a></li><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/usage/ad-hoc/>即时查询</a></li><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/usage/metric-alerting/>指标告警</a></li><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/usage/logs-alerting/>日志告警</a></li><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/usage/notify-rules/>通知规则</a></li><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/usage/dashboard/>仪表盘</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-1bf2c059b13a7f00ff98afe5f2d7d7c5 aria-expanded=false>
监控实践</button><div class=collapse id=section-1bf2c059b13a7f00ff98afe5f2d7d7c5><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/practice/linux/>Linux OS</a></li><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/practice/proc/>进程监控</a></li><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/practice/port/>端口监控</a></li><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/practice/exec/>插件脚本</a></li><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/practice/mysql/>MySQL</a></li><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/practice/redis/>Redis</a></li><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/practice/oracle/>Oracle</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-86d207ca70c494ce35a5f9d5aa684fb7 aria-expanded=true>
功能详解</button><div class="collapse show" id=section-86d207ca70c494ce35a5f9d5aa684fb7><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded active" href=https://n9e.github.io/zh/docs/usecase/alerting/>告警原理和流程说明</a></li><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/usecase/bizgroup/>业务组</a></li><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/usecase/mute/>屏蔽规则</a></li><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/usecase/subscribe/>订阅规则</a></li><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/usecase/processor/>事件处理器 Pipeline</a></li><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/usecase/media/>自定义通知媒介</a></li><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/usecase/sso/>单点登录（SSO）</a></li><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/usecase/api/>API</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-1fe917b01f9a3f87fa2d7d3b7643fac1 aria-expanded=false>
FAQ</button><div class=collapse id=section-1fe917b01f9a3f87fa2d7d3b7643fac1><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/faq/global-callback/>全局回调下线，那全局场景怎么处理？</a></li><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/faq/cpu-alerting/>CPU 负载高，到底应不应该告警？</a></li><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/faq/biz-team-subscribe-infra-alarms/>底层的告警，上层业务应该收吗？</a></li></ul></div></li></ul></nav></aside></div><div class="wrap container-xxl" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-5 col-xl-4 docs-sidebar d-none d-lg-block"><nav class=docs-links aria-label="Main navigation"><ul class="list-unstyled collapsible-sidebar"><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-df36888424843793b8bfe4fd460c9b87 aria-expanded=false>
前言</button><div class=collapse id=section-df36888424843793b8bfe4fd460c9b87><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/prologue/introduction/>夜莺项目介绍</a></li><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/prologue/prometheus/>夜莺对比 Prometheus</a></li><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/prologue/pre-knowledge/>学习夜莺的前置知识</a></li><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/prologue/architecture/>夜莺架构设计</a></li><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/prologue/flashcat/>夜莺商业版</a></li><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/prologue/videos/>入门视频教程</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-e655a410ff21cd07e7a0150491e04371 aria-expanded=false>
安装</button><div class=collapse id=section-e655a410ff21cd07e7a0150491e04371><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/install/pre-intro/>安装前置说明</a></li><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/install/upgrade/>升级</a></li><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/install/binary/>二进制部署</a></li><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/install/compose/>Docker Compose</a></li><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/install/helm/>Helm</a></li><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/install/configuration/>配置讲解</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-15ad62fa6c036f6a916b4336fe04c118 aria-expanded=false>
采集器</button><div class=collapse id=section-15ad62fa6c036f6a916b4336fe04c118><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/agent/intro/>前置说明</a></li><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/agent/categraf/>Categraf</a></li><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/agent/telegraf/>Telegraf</a></li><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/agent/datadog-agent/>Datadog-Agent</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-282a264a821e1d594e596f99f61e057d aria-expanded=false>
快速体验</button><div class=collapse id=section-282a264a821e1d594e596f99f61e057d><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/usage/datasource/>数据源</a></li><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/usage/ad-hoc/>即时查询</a></li><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/usage/metric-alerting/>指标告警</a></li><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/usage/logs-alerting/>日志告警</a></li><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/usage/notify-rules/>通知规则</a></li><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/usage/dashboard/>仪表盘</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-1bf2c059b13a7f00ff98afe5f2d7d7c5 aria-expanded=false>
监控实践</button><div class=collapse id=section-1bf2c059b13a7f00ff98afe5f2d7d7c5><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/practice/linux/>Linux OS</a></li><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/practice/proc/>进程监控</a></li><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/practice/port/>端口监控</a></li><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/practice/exec/>插件脚本</a></li><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/practice/mysql/>MySQL</a></li><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/practice/redis/>Redis</a></li><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/practice/oracle/>Oracle</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-86d207ca70c494ce35a5f9d5aa684fb7 aria-expanded=true>
功能详解</button><div class="collapse show" id=section-86d207ca70c494ce35a5f9d5aa684fb7><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded active" href=https://n9e.github.io/zh/docs/usecase/alerting/>告警原理和流程说明</a></li><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/usecase/bizgroup/>业务组</a></li><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/usecase/mute/>屏蔽规则</a></li><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/usecase/subscribe/>订阅规则</a></li><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/usecase/processor/>事件处理器 Pipeline</a></li><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/usecase/media/>自定义通知媒介</a></li><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/usecase/sso/>单点登录（SSO）</a></li><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/usecase/api/>API</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-1fe917b01f9a3f87fa2d7d3b7643fac1 aria-expanded=false>
FAQ</button><div class=collapse id=section-1fe917b01f9a3f87fa2d7d3b7643fac1><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/faq/global-callback/>全局回调下线，那全局场景怎么处理？</a></li><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/faq/cpu-alerting/>CPU 负载高，到底应不应该告警？</a></li><li><a class="docs-link rounded" href=https://n9e.github.io/zh/docs/faq/biz-team-subscribe-infra-alarms/>底层的告警，上层业务应该收吗？</a></li></ul></div></li></ul></nav></div><nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=page-links><h3>On this page</h3><nav id=TableOfContents><ul><li><a href=#数据流原理概述>数据流原理概述</a></li><li><a href=#告警规则>告警规则</a></li><li><a href=#事件持久化>事件持久化</a></li><li><a href=#告警规则关联通知规则>告警规则关联通知规则</a></li><li><a href=#通知规则配置>通知规则配置</a><ul><li><a href=#事件处理器>事件处理器</a></li><li><a href=#通知配置>通知配置</a></li></ul></li></ul></nav></div></nav><main class="docs-content col-lg-11 col-xl-9"><h1>告警原理和流程说明</h1><p class=lead></p><nav class=d-xl-none aria-label="Quaternary navigation"><div class=page-links><h3>On this page</h3><nav id=TableOfContents><ul><li><a href=#数据流原理概述>数据流原理概述</a></li><li><a href=#告警规则>告警规则</a></li><li><a href=#事件持久化>事件持久化</a></li><li><a href=#告警规则关联通知规则>告警规则关联通知规则</a></li><li><a href=#通知规则配置>通知规则配置</a><ul><li><a href=#事件处理器>事件处理器</a></li><li><a href=#通知配置>通知配置</a></li></ul></li></ul></nav></div></nav><p>夜莺监控（Nightingale）的功能侧重点是告警引擎，为了做得灵活，整个告警流程涉及到的功能点比较多，本文从原理和数据流的角度，介绍一下相关知识，理解这些知识，对于您使用夜莺、排查告警问题，都会有帮助。</p><h2 id=数据流原理概述>数据流原理概述 <a href=#%e6%95%b0%e6%8d%ae%e6%b5%81%e5%8e%9f%e7%90%86%e6%a6%82%e8%bf%b0 class=anchor aria-hidden=true>#</a></h2><img src=/img/usecase/alerting/01.png alt=夜莺告警数据流原理概述 title=夜莺告警数据流原理概述><ol><li>用户在 Web UI 配置告警规则，规则保存在 DB 中（通常是 MySQL）。</li><li>告警引擎（<code>n9e</code> 进程内置一个告警引擎，边缘模式下 <code>n9e-edge</code> 进程里也内置告警引擎）从 DB 同步告警规则到内存中（通常 <code>n9e-edge</code> 无法直接读 DB，是调用的中心端 <code>n9e</code> 的接口获取的告警规则）。</li><li>告警引擎会为每条告警规则创建一个 goroutine（协程，姑且可以理解为轻量级线程），按照用户在告警规则里配置的频率，周期性查询存储，对数据做异常判定，最终生成告警事件。</li><li>产生告警事件后，要先持久化到 DB 中（通常是 MySQL），然后再走后面的通知规则。</li><li>通知规则包含两部分，一个是若干事件处理器（比如 relabel、event update、event drop、ai summary 等），另一个是若干告警通知配置（比如 Critical 的告警事件关联电话、短信通知媒介，Warning 的告警事件只关联邮件媒介）。</li></ol><h2 id=告警规则>告警规则 <a href=#%e5%91%8a%e8%ad%a6%e8%a7%84%e5%88%99 class=anchor aria-hidden=true>#</a></h2><p>告警规则核心就是配置一个查询条件，比如 Prometheus 数据源就是配置 PromQL，ClickHouse 数据源就是配置 SQL，然后再配置一个阈值（Prometheus 场景下，阈值包含在 PromQL 中，不需要单独配置），达到阈值并满足持续时长，就告警。</p><p>告警引擎针对每条规则创建一个 goroutine（协程），周期性地查询数据源，判断是否满足告警条件。以 Prometheus 数据源举例，其原理是：</p><ul><li>夜莺周期性调用数据源的 <code>/api/v1/query</code> 接口，把当前时间和 PromQL 作为查询条件传给这个接口。</li><li>数据源如果返回多条记录，大概率就要生成多条告警事件，接下来要看持续时长，如果持续时长为 0，立马生成告警事件，如果持续时长大于 0，就要把这条记录放到一个缓存中，等到持续时长满足条件后，再生成告警事件，在持续时长过程中，如果后面的执行周期查不到数据了，就会把这条记录从缓存中删除，也就不会生成告警事件了。</li></ul><p>这里经常遇到的问题是，告警引擎在查询的时候没有查到数据，故而无法生成告警事件，但是后面排查的时候发现那个时间点却是有数据满足阈值的，百思不得其解，这种情况，可能的原因有两个：</p><ul><li>因为监控数据的上报有延迟导致的，在这里夜莺只是一个 client，数据源是 server，数据源没有返回数据，就要去看 server 侧的问题，看 server 侧的数据为啥没有返回，通常是数据有各种因素延迟了。</li><li>查询超时了，日志文件里通常可以看到相关日志，可以在数据源配置页面调大查询超时时间，或者排查数据源为啥返回慢了，另外硬件方面也可能有问题，比如 client、server 两边是否有网卡丢包。超时的日志，可以检索关键字：<code>alert-${datasource-id}-${alert-rule-id}</code></li></ul><p>其中：</p><ul><li><code>${datasource-id}</code> 是数据源的 ID，在数据源详情页面可以看到</li><li><code>${alert-rule-id}</code> 是告警规则的 ID，编辑告警规则时，在 URL 中可以看到</li></ul><p>告警问题排查时，首先要看是否产生了告警事件，如果产生了告警事件，说明告警规则没问题，接下来再排查后面通知相关的问题，如果告警事件都没有产生，那就是告警规则和数据源的问题，首先要确认告警规则的配置再谈其他。</p><h2 id=事件持久化>事件持久化 <a href=#%e4%ba%8b%e4%bb%b6%e6%8c%81%e4%b9%85%e5%8c%96 class=anchor aria-hidden=true>#</a></h2><p>告警事件产生后需要写入 DB（通常是 MySQL），于是你才能在告警事件列表中看到这个事件。有时会写失败，写失败的话在日志里通常会有体现，排查 WARNING 和 ERROR 日志即可。</p><h2 id=告警规则关联通知规则>告警规则关联通知规则 <a href=#%e5%91%8a%e8%ad%a6%e8%a7%84%e5%88%99%e5%85%b3%e8%81%94%e9%80%9a%e7%9f%a5%e8%a7%84%e5%88%99 class=anchor aria-hidden=true>#</a></h2><p>告警事件产生之后，应该走后续的哪个通知规则？即告警规则和通知规则如何建立关联关系？有两个办法建立关联关系：</p><ul><li>告警规则里直接配置通知规则。即这个告警规则产生的所有告警事件，都要走这些通知规则。</li><li>告警规则里不配通知规则，而是配置订阅规则，即：在订阅规则里按照各种条件筛选告警事件，筛选到的告警事件，走订阅规则里配置的通知规则。</li></ul><p>上面两种方式都可以，前者更直观，如果没有特殊需求，推荐使用前者。但是对于一些全局的事件处理，比如我想把夜莺监控中产生的所有告警事件都走一个 Callback 处理器，此时可以使用订阅规则，订阅所有的告警事件，统一关联一个全局通知规则，在这个全局通知规则里配置 Callback 处理器。</p><h2 id=通知规则配置>通知规则配置 <a href=#%e9%80%9a%e7%9f%a5%e8%a7%84%e5%88%99%e9%85%8d%e7%bd%ae class=anchor aria-hidden=true>#</a></h2><p>下图是通知规则的编辑页面，我在图中标注了各个区块的作用：</p><img src=/img/usecase/alerting/02.png alt=夜莺通知规则配置 title=夜莺通知规则配置><p>大部分表单项的标题位置，都有一个小问号图标，鼠标悬停在上面会有提示信息，大家可以参考提示信息来配置。</p><blockquote><p>💡 这个页面里包含一些通知测试的按钮，点击之后，可以选择已生成的告警事件做通知规则的测试，便于您快速验证通知规则是否符合预期。另外要注意，告警事件持久化发生在通知规则之前，所以通知规则里的各个事件处理器，不会对 DB 中的告警事件产生修改。</p></blockquote><h3 id=事件处理器>事件处理器 <a href=#%e4%ba%8b%e4%bb%b6%e5%a4%84%e7%90%86%e5%99%a8 class=anchor aria-hidden=true>#</a></h3><blockquote><p>💡 事件 Pipeline 并没有一个单独的菜单入口，作为通知规则的一部分，是在通知规则的编辑页面里，点击「事件处理」区块的小齿轮图标可以展开事件处理器的配置侧拉板。</p></blockquote><p>事件处理器是一个高级机制，允许您对告警事件做各种处理，比如：</p><ul><li>对告警事件做 relabel，拆分一些标签，修改一些标签等</li><li>更新告警事件，夜莺把告警事件传给第三方（比如 CMDB ）接口，第三方可以对告警事件做修改，然后把修改之后的内容返回，继续走后续事件处理逻辑，方便与外部系统做打通</li><li>丢弃告警事件，一些告警事件不需要通知，可以在这里做复杂的判断，符合条件的丢弃掉</li><li>生成 AI 摘要，把告警事件传给 DeepSeek 等，让 AI 帮忙生成摘要和解法，把 AI 生成的内容放到事件中，后续通过通知媒介发出来</li></ul><p>这里有两个概念要注意：</p><ul><li>事件处理的 Pipeline，就是点击<code>通知规则-事件处理</code>右侧那个按钮展开的侧拉板，里边就是 Pipeline 的列表</li><li>每个 Pipeline 可以包含多个 Processor（处理器），如果想提高复用性，也可以简单来搞，每个 Pipeline 只包含一个 Processor。</li></ul><p>每个处理器，页面上都有一个文档说明链接，点击之后可以查看详细的文档说明。也可以参考下面两个链接的资料：</p><ul><li><a href=/zh/docs/usecase/processor/>事件处理器说明</a></li><li><a href=/zh/docs/usecase/media/>自定义通知媒介</a></li><li><a href=https://mp.weixin.qq.com/s/Of90imqi0T_fV1QGxAkR0Q>开源夜莺监控实现发版时告警静默</a></li></ul><h3 id=通知配置>通知配置 <a href=#%e9%80%9a%e7%9f%a5%e9%85%8d%e7%bd%ae class=anchor aria-hidden=true>#</a></h3><p>这部分在前面已经讲解过，这里不再赘述，请参考：</p><ul><li><a href=/zh/docs/usage/notify-rules/>通知规则设计初衷和使用说明</a></li></ul><div class=docs-edit-tip>🎯 由于读者水平参差不齐，重口难调，社区小伙伴一直在持续更新优化文档内容，如果您觉得本页文档内容有误或不够完善，欢迎您参与到文档的编写中来，点击下方的 Edit this page on GitHub 即可编辑 👇</div><div class="page-footer-meta d-flex flex-column flex-md-row justify-content-between"><div class=edit-page><a href=https://github.com/n9e/n9e.github.io/blob/master/content/zh/docs/usecase/alerting.md><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit-2"><path d="M17 3a2.828 2.828.0 114 4L7.5 20.5 2 22l1.5-5.5L17 3z"/></svg>Edit this page on GitHub</a></div></div><div class="docs-navigation d-flex justify-content-between"><a href=/zh/docs/practice/oracle/><div class="card my-1"><div class="card-body py-2">&larr; Oracle</div></div></a><a class=ms-auto href=/zh/docs/usecase/bizgroup/><div class="card my-1"><div class="card-body py-2">业务组 &rarr;</div></div></a></div></main></div></div></div><footer class="footer text-muted"><div class=container-xxl><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item>&copy; 2025 CCF·Nightingale, all rights reserved.</li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-end"><ul class=list-inline></ul></div></div></div></footer><script src=/js/bootstrap.min.0a0106334435d4110713bfaff4acaf02533b0c56d44412a74e9518db07672ddb7e099a9c7517bc9cb529e2ddd4ae2e438b40b720288900d5e74fb6d8928d9097.js integrity="sha512-CgEGM0Q11BEHE7+v9KyvAlM7DFbURBKnTpUY2wdnLdt+CZqcdRe8nLUp4t3Uri5Di0C3ICiJANXnT7bYko2Qlw==" crossorigin=anonymous defer></script>
<script src=/js/highlight.min.0d31f7af12feb83ee633b6351b023ee643ea3412376fbaa09c5a26d1a5ef999939f1ad379a5b12e1199a2c7d72ae1b23f633060a679628dcbfb0e72378cd20be.js integrity="sha512-DTH3rxL+uD7mM7Y1GwI+5kPqNBI3b7qgnFom0aXvmZk58a03mlsS4RmaLH1yrhsj9jMGCmeWKNy/sOcjeM0gvg==" crossorigin=anonymous defer></script>
<script src=/main.min.6afc4bf655f45ae3e63629ec95be8bd2e0e792084b5635a6fe70b169fa9d1491638b3a4e900ed59c2e017ca18768e5c392e110d0e1336509f49f7dc418d16eef.js integrity="sha512-avxL9lX0WuPmNinslb6L0uDnkghLVjWm/nCxafqdFJFjizpOkA7VnC4BfKGHaOXDkuEQ0OEzZQn0n33EGNFu7w==" crossorigin=anonymous defer></script>
<script src=https://n9e.github.io/index.min.08961e263755b7b0ff0ed3064fe23df9f6d6057b0045e4111629bb5723b8d8018ae4c4f7ba75e644e35d84bb5c20d07a87e3b9ba8d855d80f291da2e79175115.js integrity="sha512-CJYeJjdVt7D/DtMGT+I9+fbWBXsAReQRFim7VyO42AGK5MT3unXmRONdhLtcINB6h+O5uo2FXYDykdoueRdRFQ==" crossorigin=anonymous defer></script>
<script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?9d7cc507a7aae60b28b5e04bb995492a",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script></body></html>