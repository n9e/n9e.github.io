<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Grafana-agent on</title><link>https://n9e.github.io/zh/docs/appendix/grafana-agent/</link><description>Recent content in Grafana-agent on</description><generator>Hugo -- gohugo.io</generator><language>en-US</language><lastBuildDate>Tue, 06 Oct 2020 08:48:45 +0000</lastBuildDate><atom:link href="https://n9e.github.io/zh/docs/appendix/grafana-agent/index.xml" rel="self" type="application/rss+xml"/><item><title>总览</title><link>https://n9e.github.io/zh/docs/appendix/grafana-agent/grafana-agent-overview/</link><pubDate>Tue, 06 Oct 2020 08:48:45 +0000</pubDate><guid>https://n9e.github.io/zh/docs/appendix/grafana-agent/grafana-agent-overview/</guid><description>Acknowledgement: Grafana Agent is a lightweight telemetry collector based on Prometheus that only performs its scraping and remote_write functions. Agent can also collect metrics, logs, and traces for storage in Grafana Cloud and Grafana Enterprise, as well as OSS deployments of Loki (logs), and Tempo (traces), Prometheus (metrics), and Cortex (metrics). Grafana Agent also contains several integrations (embedded metrics exporters) like node-exporter, a MySQL exporter, and many more.
如果您使用和管理着Kubernetes集群以及您的应用运行在Kubernetes之上，请参考 在K8s中使用grafana-agent。</description></item><item><title>收集metrics</title><link>https://n9e.github.io/zh/docs/appendix/grafana-agent/k8s_metrics/</link><pubDate>Tue, 06 Oct 2020 08:48:45 +0000</pubDate><guid>https://n9e.github.io/zh/docs/appendix/grafana-agent/k8s_metrics/</guid><description>在本文档中，介绍如何以Deployment或者Daemonset的方式部署grafana-agent到您的k8s集群中，抓取宿主机上kubelet和cAdvisor的metrics指标，并把抓取到的数据，以remote_write的方式推送到Nightingale.
通过本文档，我们预期达成以下目标：
部署grafana-agent到您的K8s集群中； 配置grafana-agent抓取kubelet和cAdvisor的metrics； K8s是开源的容器编排系统，自动化管理容器的部署、扩缩容等工作。K8s默认会暴露Node和控制面的若干metrics接口，这些接口兼容Prometheus的metrics规范。我们可以部署grafana-agent来收集Node的cAdvisor和kubelet metrics，并以remote_write的方式发送到Nightingale.
前置依赖 # 一个开启RBAC（role-based access control）的Kubernetes集群； 安装并配置好了kubectl命令行工具； 步骤一：创建 ServiceAcount、ClusterRole、ClusterRoleBinding # export NAMESPACE=default MANIFEST_URL=https://raw.githubusercontent.com/flashcatcloud/fc-agent/fc-release/etc/k8s/agent-bare.yaml curl -fsSL $MANIFEST_URL | envsubst | kubectl apply -f - 步骤二：创建ConfigMap，配置grafana-agent # export NAMESPACE=default export CLUSTER_NAME=kubernetes export FC_REMOTE_WRITE_URL=http://10.206.0.16:8480/insert/0/prometheus/api/v1/write #export FC_REMOTE_WRITE_URL=https://n9e-server:19000/prometheus/v1/write #export FC_REMOTE_WRITE_USERNAME=fc_laiwei #export FC_REMOTE_WRITE_PASSWORD=fc_laiweisecret cat &amp;lt;&amp;lt;EOF | kind: ConfigMap metadata: name: grafana-agent apiVersion: v1 data: agent.yaml: | server: http_listen_port: 12345 metrics: wal_directory: /tmp/grafana-agent-wal global: scrape_interval: 15s scrape_timeout: 10s external_labels: cluster: ${CLUSTER_NAME} configs: - name: integrations remote_write: - url: ${FC_REMOTE_WRITE_URL} basic_auth: username: ${FC_REMOTE_WRITE_USERNAME} password: ${FC_REMOTE_WRITE_PASSWORD} scrape_configs: - job_name: integrations/kubernetes/cadvisor bearer_token_file: /var/run/secrets/kubernetes.</description></item><item><title>收集logs</title><link>https://n9e.github.io/zh/docs/appendix/grafana-agent/k8s_logs/</link><pubDate>Tue, 06 Oct 2020 08:48:45 +0000</pubDate><guid>https://n9e.github.io/zh/docs/appendix/grafana-agent/k8s_logs/</guid><description>在本文档中，介绍如何以Daemonset的形式部署grafana-agent到您的k8s集群中，收集您的K8s集群中应用的日志，并将其推送到Nightingale.</description></item><item><title>收集trace</title><link>https://n9e.github.io/zh/docs/appendix/grafana-agent/k8s_traces/</link><pubDate>Tue, 06 Oct 2020 08:48:45 +0000</pubDate><guid>https://n9e.github.io/zh/docs/appendix/grafana-agent/k8s_traces/</guid><description>在本文档中，介绍如何以 Deployment 的形式部署grafana-agent到您的K8s集群中，收集您的K8s集群中应用的trace数据，并将其推送到Nightingale.</description></item><item><title>收集三方exporter</title><link>https://n9e.github.io/zh/docs/appendix/grafana-agent/scrape_exporters/</link><pubDate>Tue, 06 Oct 2020 08:48:45 +0000</pubDate><guid>https://n9e.github.io/zh/docs/appendix/grafana-agent/scrape_exporters/</guid><description>对于未嵌入到 grafana-agent中的 exporter，则可以在 grafana-agent 中配置 scrape_configs 来完成抓取和收集，请参考抓取第三方exporter。</description></item><item><title>监控K8s</title><link>https://n9e.github.io/zh/docs/appendix/grafana-agent/how-to-monitoring-k8s/</link><pubDate>Tue, 06 Oct 2020 08:48:45 +0000</pubDate><guid>https://n9e.github.io/zh/docs/appendix/grafana-agent/how-to-monitoring-k8s/</guid><description>Acknowledgement: grafana-agent is powered by Grafana Agent. Grafana Agent is a lightweight telemetry collector based on Prometheus that only performs its scraping and remote_write functions. Agent can also collect metrics, logs, and traces for storage in Grafana Cloud and Grafana Enterprise, as well as OSS deployments of Loki (logs), and Tempo (traces), Prometheus (metrics), and Cortex (metrics). Grafana Agent also contains several integrations (embedded metrics exporters) like node-exporter, a MySQL exporter, and many more.</description></item></channel></rss>